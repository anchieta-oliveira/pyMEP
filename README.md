# pyMEP
The pyMEP (Python Molecular Electrostatic Potential) is a Python library designed for the calculation and visualization of Molecular Electrostatic Potentials (MEP), which can be accelerated by GPU.


![Figure 1](https://github.com/anchieta-oliveira/pyMEP/blob/main/gallery/fig_8Y3C.png)
Figure 1: Molecular Electrostatic Potential (MEP) map of di-nucleosome (closed form) protein alone (20,416 atoms and 10,289,600 grid points) and complex DNA protein (36,273 atoms and 18,298,710 grid points) (PDB ID: 8Y3C). You can see the electrostatic complementarity between the positive charges of the protein (blue) and the negative charges of the RNA (red).  


## Prerequisites
Ensure you have the following installed on your system:
- [Python 3.8+](https://www.python.org/downloads/)
- [Conda Package Manager](https://docs.conda.io/en/latest/miniconda.html) (Miniconda or Anaconda)
- (Optional) Git - for cloning the repository

## Installation 
### Step 1: Clone the Repository
Use Git to clone the repository to your local machine:
```bash
git clone https://github.com/anchieta-oliveira/pyMEP
```

### Step 2: Create a virtual environment dedicated to pyMEP
Navigate to the cloned Git folder:
```bash
cd pyMEP
```
Create a new Conda environment using the provided requirements.yml file:
```bash
conda env create -f environment.yml
```

### Step 3: Then install the package
Optionally, install install the package
```bash
python -m pip install -e .
```

## Usage Guide 
### Step 1: Activate the pyMEP dedicated environment:
```bash
conda activate pyMEP
```

### Step 2: Call pyMEP
Displaying pyMEP usage options:
```bash
python3.12 path/to/main.py --help
```

Uso simples:
```bash
python3.12  path/to/main.py -pdb to_pdb.pdb -psf to_psf.psf -o mep.cube
```

Arguments:
-  `-h`, `--help`       Show this help message and exit
-  `-ff`, `--force_field` FORCE_FIELD
                        Force field file used for calculations (e.g., CHARMM).
-  `-mop`, `--mopac_file` MOPAC_FILE
                        MOPAC output file.
-  `-orca`, `--orca_file` ORCA_FILE
                        ORCA output file.
-  `-xtb`, `--xtb_file_charge` XTB_FILE_CHARGE
                        XTB output charge file for charge.
-  `-psf`, `--psf_file` PSF_FILE
                        System topology file (PSF), typically generated by software like VMD or CHARMM.
-  `-chg_file`, `--charge_file` CHARGE_FILE
                        Path to the file containing charge information.
-  `-gpu`, `--gpu`           Enable GPU acceleration if available.
-  `-gpu_id`, `--gpu_id` GPU_ID
                        Specify the GPU ID to use (default: all gpus).
-  `-o`, `--output` OUTPUT
                        Path to the output file or directory where results will be saved.
-  `-cutoff`, `--cutoff` CUTOFF
                        Path to the output file or directory where results will be saved.
-  `-gs`, `--grid_spacing` GRID_SPACING
                        Grid spacing value to be used in calculations (default: 1).
-  `-m`, `--margin` MARGIN
                        Margin value to be used in calculations (default: 0.3).
-  `-pdb`, `--pdb_file` PDB_FILE
                        PDB file.
-  `-xyz`, `--xyz_file` XYZ_FILE
                        XYZ file.


## Benchmark
![Figura 2](https://github.com/anchieta-oliveira/pyMEP/blob/main/benchmark/2luf_cpu_gpu.png)
Figura 2: Benchmark using TRA-cage (PDB ID: 2LUF) varying grid space, resulting in a greater number of points on the grid. We used a computer with an i9-7900X, 20 threads (3.30 GHz) 32 GB RAM and NVIDIA GeForce GTX 1080 Ti.

![Figure X](https://github.com/anchieta-oliveira/pyMEP/blob/main/gallery/fig_1PGL.png)
Figure 1: Molecular Electrostatic Potential (MEP) map of Bean Pod Mottle Virus (BPMV) (PDB ID: 1PGL). pyMEP can handle large systems in a timely manner, using multiple GPUs; PDB 1PGL contains 525,600 atoms, a grid with 16,836,644 points.

### Run the benchmark with your resources:
Activate the pyMEP dedicated environment:
```bash
conda activate pyMEP
```

```bash
cd to/pyMEP/benchmark
```

Unzip data.zip and run the python script:
```bash
python3.12 run_benchmark.py
```

```bash
python3.12 run_benchmark_multi_gpu.py
```
